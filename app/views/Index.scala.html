@import controller.SearchController

@Main(title = "Catalog search") {
<div class="container">
    <h1>Biblioteka Raczynskich</h1>
    <p>
    <input id="inputIsbn" type="text" name="isbn" class="form-control">
    <button id="searchIsbn" type="submit" class="btn btn-default">Search</button>
    </p>
    <p id="results"></p>
    <hr>
    <p id="history"></p>
    <script>
    $('#searchIsbn').click(function(){
        var req = new XMLHttpRequest();
        req.open('GET', '/search/?isbn=' + document.getElementById('inputIsbn').value, true);
        req.onload = function(e) {
            document.getElementById('results').innerHTML = req.responseText;
            showHistory();
        }
        req.send(null);
    });
    function showHistory() {
        var req = new XMLHttpRequest();
        req.open('GET', '/history', true);
        req.onload = function(e) {
            document.getElementById('history').innerHTML = req.responseText;
            linksForHistory();
        }
        req.send(null);
    }
    function linksForHistory() {
        var links = document.getElementById('links');
        if (links) {
            var history = links.getElementsByTagName('li');
            for (var i = 0; i < history.length; ++i) {
                history[i].onclick = function(e) {
                    document.getElementById('inputIsbn').value = this.getElementsByTagName('a')[0].text;
                };
            }
        }
    }
    showHistory();
    </script>
</div>
}
